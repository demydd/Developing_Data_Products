{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n\n#connect libraries required\nif(!require(shiny)){\n  library(shiny)  \n}\nif(!require(shinyjs)){\n  library(shinyjs)  \n}\nif(!require(shinyBS)){\n  library(shinyBS)\n}\n\nx_variables <-NA\ndf <- NA\ntime <-0\n\n\nshinyServer(function(input, output,session) {\n  \n  observe({\n    #to secure non-editable elements\n    disable(\"summary\")\n    disable(\"y_dependable\") #the column with good/bad values\n    disable(\"performance\")\n    \n    #to define the theoretical dataframe for further runs\n    setNames <-paste(\"V\",c(1:input$predictors),sep=\"\")\n    df <<- as.data.frame(matrix(rnorm(as.integer(input$observations)*input$predictors),nrow=(as.integer(input$observations)),ncol=(input$predictors)))\n    df[,1] <<- sample(0:1, as.integer(input$observations), replace=T)\n    names(df)<-setNames\n    \n    #write the essential data about modelling\n    updateTextInput(session,\"summary\",value=NULL)\n    \n    \n    updateTextInput(session,\"summary\",value=paste( \"Predictor qty =\",input$predictors,\"\\n\"\n                                                  ,\"Observation qty =\",input$observations,\"\\n\"\n                                                  ,\"Dependent variable =\",input$y_dependable,\"\\n\"\n                                                  ,\"Model type =\",input$models,\"\\n\"\n                                                  \n                                                 )\n                    )\n\n    \n    \n    \n  })\n  \n  observeEvent(input$predictors,{\n    \n    setId <- 1:input$predictors\n    setNames <-paste(\"V\",c(1:input$predictors),sep=\"\")\n    #updateSelectInput(session,\"y_dependable\",choices = c(setNames,setId))\n    \n    observe({\n  \n      x_variables <<- c(setNames)[which((c(setNames) %in% input$y_dependable)==FALSE)]\n      if (length(x_variables)==1) stop(\"You must choose more then 1 predictor!\")\n    })\n    \n  })\n  \n  \n  observeEvent(input$go_button,{\n    disable(\"go_button\")\n    \n    if (length(x_variables)==0) stop(\"You must choose more then 1 predictor!\")\n\n    formulaText <- formula(paste(input$y_dependable,\"~\",paste(x_variables,collapse=\"+\")))\n    \n    time <<- system.time(\n                          fullmodel <- glm(formulaText, family = eval(input$models), data = df)\n                        )\n    #updateTextInput(session,\"performance\",value = paste (names(time[1]),names(time[2]),names(time[3]),\"\\n\",time[1],time[2],time[3]))\n    output$performance <- renderPrint({\n      time\n    })\n    \n    \n    output$wide_summary <- renderPrint({\n      summary(fullmodel)\n    })\n\n    \n    enable(\"go_button\")\n    \n  }) \n  \n  output$help <- renderPrint({\n    p(\"What for the Shiny app is?\nThe initial goal of this Shiny app is to demonstrate how to use different functions of “glm” family (their output and performance indicators (time)) such as:\n1.\tbinomial\n2.\tgaussian\n3.\tpoisson\n4.\tquasibinomial\n5.\tquasipoisson\n      \n      \nAll function settings are considered to be default but for the data frame dimensions and model type (types of “glm“ family). The data frame is filled up with “rnorm” function.\n      \nThe description of App’s elements: \n      \nsliderInput(‘predictors’,’Qty of predictors selected’) – define the number of predictors to be used in the theoretical data frame. \nThe default value is “1”. You must pick up, at least, two predictors otherwise the script will throw the warning and stop the App.\n      \ntextInput(‘observations’,’Qty of observations’) – define the number of observation\n      \nselectInput(‘y_dependable’,’,’Select predictor as Y’) – define the dependant variable. The element is disabled. On default it is “V1” (contains 1 or 0 values).\n      \nselectInput(‘models’, ‘Model type selected’) – define the type of model selected.\n      \nWhen all elements are defined -> press the button ‘Run model calculations!’\"\n    )\n\n    \n  })\n  \n})\n",
    "created" : 1463991565899.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1076220697",
    "id" : "6CE84E5",
    "lastKnownWriteTime" : 1464017776,
    "path" : "D:/Demyd/Personal/Coursera/Developing_Data_Products/project/project_ddp/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}